(function(e){function t(t){for(var a,r,i=t[0],s=t[1],u=t[2],d=0,m=[];d<i.length;d++)r=i[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&m.push(o[r][0]),o[r]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);h&&h(t);while(m.length)m.shift()();return c.push.apply(c,u||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],a=!0,r=1;r<n.length;r++){var i=n[r];0!==o[i]&&(a=!1)}a&&(c.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={app:0},o={app:0},c=[];function i(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-15dd1d9c":"9f05d4d5","chunk-2078c21c":"7dfde860","chunk-2a27a44d":"6a664cbb","chunk-3127b385":"37f36462","chunk-3a262b16":"b0c03f6f","chunk-1fb3d024":"def57d31","chunk-55fd61f7":"221e477c","chunk-4b934a4c":"861bb392","chunk-5a5675a9":"b1f7b7df","chunk-5ab19ff9":"52d29d46","chunk-55124650":"4bda9328","chunk-7f1cab86":"51f1dd60","chunk-6a420968":"7c22bcb0","chunk-00540dc5":"d687713d","chunk-73e0c042":"e4e025d4","chunk-710b448a":"649496fa","chunk-753b42ec":"e63d0b4a","chunk-c7879cac":"2301f167"}[e]+".js"}function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n={"chunk-15dd1d9c":1,"chunk-2078c21c":1,"chunk-2a27a44d":1,"chunk-3127b385":1,"chunk-3a262b16":1,"chunk-1fb3d024":1,"chunk-55fd61f7":1,"chunk-4b934a4c":1,"chunk-5a5675a9":1,"chunk-5ab19ff9":1,"chunk-55124650":1,"chunk-7f1cab86":1,"chunk-6a420968":1,"chunk-00540dc5":1,"chunk-73e0c042":1,"chunk-710b448a":1,"chunk-753b42ec":1,"chunk-c7879cac":1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise((function(t,n){for(var a="css/"+({}[e]||e)+"."+{"chunk-15dd1d9c":"10b4f126","chunk-2078c21c":"a7ac6c94","chunk-2a27a44d":"1821bc6b","chunk-3127b385":"27d3f6b3","chunk-3a262b16":"b3f35850","chunk-1fb3d024":"b76fbe37","chunk-55fd61f7":"9aa7a4ce","chunk-4b934a4c":"a87e0788","chunk-5a5675a9":"091b9133","chunk-5ab19ff9":"7e3c7c5e","chunk-55124650":"6de0bd08","chunk-7f1cab86":"d764a827","chunk-6a420968":"f47608dd","chunk-00540dc5":"d2ef226a","chunk-73e0c042":"90727e64","chunk-710b448a":"1a3dcbc9","chunk-753b42ec":"60c5c530","chunk-c7879cac":"e655db7e"}[e]+".css",o=s.p+a,c=document.getElementsByTagName("link"),i=0;i<c.length;i++){var u=c[i],d=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(d===a||d===o))return t()}var m=document.getElementsByTagName("style");for(i=0;i<m.length;i++){u=m[i],d=u.getAttribute("data-href");if(d===a||d===o)return t()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=t,h.onerror=function(t){var a=t&&t.target&&t.target.src||o,c=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");c.code="CSS_CHUNK_LOAD_FAILED",c.request=a,delete r[e],h.parentNode.removeChild(h),n(c)},h.href=o;var l=document.getElementsByTagName("head")[0];l.appendChild(h)})).then((function(){r[e]=0})));var a=o[e];if(0!==a)if(a)t.push(a[2]);else{var c=new Promise((function(t,n){a=o[e]=[t,n]}));t.push(a[2]=c);var u,d=document.createElement("script");d.charset="utf-8",d.timeout=120,s.nc&&d.setAttribute("nonce",s.nc),d.src=i(e);var m=new Error;u=function(t){d.onerror=d.onload=null,clearTimeout(h);var n=o[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;m.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",m.name="ChunkLoadError",m.type=a,m.request=r,n[1](m)}o[e]=void 0}};var h=setTimeout((function(){u({type:"timeout",target:d})}),12e4);d.onerror=d.onload=u,document.head.appendChild(d)}return Promise.all(t)},s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/go_farmmy_vue/",s.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],d=u.push.bind(u);u.push=t,u=u.slice();for(var m=0;m<u.length;m++)t(u[m]);var h=d;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"2fa3":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("bc3a"),r=n.n(a);const o="https://go-farmmy-api-rywu.onrender.com/api",c=r.a.create({baseURL:o})},4360:function(e,t,n){"use strict";n("d9e2"),n("14d9");var a=n("2b0e"),r=n("2f62"),o=n("3d20"),c=n.n(o),i=n("4cce"),s=n("cc17");const u={shoppingCart:[],shippingInfo:{},totalPrice:0,controlButton:!1},d={updateProducts(e,t){e.shoppingCart=[...t]},effectButton(e){e.controlButton=!1},blockButton(e){e.controlButton=!0},updateDelivery(e,t){e.shippingInfo={...t}},updateTotlePrice(e,t){e.totalPrice=t},addProductinCart(e,t){const n=e.shoppingCart.findIndex(e=>e.id===t.id);if(-1!==n){let a=e.shoppingCart[n].number;e.shoppingCart[n].number=Number(a)+Number(t.number)}else e.shoppingCart.push({...t,number:t.number})},increaseItem(e,t){const n=e.shoppingCart.filter(e=>e.name===t.name);n[0].number+=1},decreaseItem(e,t){const n=e.shoppingCart.filter(e=>e.name===t.name);n[0].number-=1},deleteItem(e,t){const n=e.shoppingCart.filter(e=>e.name!==t.name);e.shoppingCart=[...n]}},m={async fetchSoppingCard({commit:e}){try{const{data:t}=await s["a"].getCart(),{cart:n}=t;let a=[];return"empty"!==n&&(a=n.items.map(e=>({...e,number:e.CartItem.quantity}))),e("updateDelivery",t.shippingInfo),e("updateTotlePrice",t.totalPrice),e("updateProducts",a),e("effectButton"),!0}catch(t){c.a.fire({icon:"error",title:"購物車載入失敗，請稍後再試！",toast:!0,showConfirmButton:!1,timer:2e3}),console.log(t)}},async addEmptyShoppingCart({commit:e,dispatch:t},n){try{e("updateProducts",n);const a=await Promise.all(n.map(async e=>await s["a"].postCart({productId:e.id,quantity:e.number})));if("success"!==a[0].data.status)throw new Error(a[0].data.status);t("fetchSoppingCard")}catch(a){c.a.fire({icon:"error",title:"購物車添加失敗，請稍後再試！",toast:!0,showConfirmButton:!1,timer:2e3}),console.log(a)}},async ChangeShoppingCart({dispatch:e},t){try{const n=await s["a"].deleteAllCartItem();"success"===n.data.status&&0!=t.length&&e("addEmptyShoppingCart",t),"success"===n.data.status&&0===t.length&&e("fetchSoppingCard")}catch(n){console.log(n),c.a.fire({icon:"error",title:"購物車更新失敗，請稍後再試！",toast:!0,showConfirmButton:!1,timer:2e3})}},async increaseItemNumber({commit:e,dispatch:t},n){try{e("blockButton"),e("increaseItem",n);const a=await s["a"].postAddCartItem({Id:n.id});if(200!==a.status)throw new Error(a.status);t("fetchSoppingCard")}catch(a){e("decreaseItem",n),c.a.fire({icon:"error",title:"增加失敗，請稍後再試！",toast:!0,showConfirmButton:!1,timer:2e3})}},async decreaseItemNumber({commit:e,dispatch:t},n){try{e("blockButton"),e("decreaseItem",n);const a=await s["a"].postSubCartItem({Id:n.id});if(200!==a.status)throw new Error(a.status);t("fetchSoppingCard")}catch(a){c.a.fire({icon:"error",title:"減少失敗，請稍後再試！",toast:!0,showConfirmButton:!1,timer:2e3}),e("increaseItem",n)}},async deleteItem({commit:e,dispatch:t},n){try{e("blockButton"),e("deleteItem",n);const a=await s["a"].deleteCartItem({Id:n.id});if("success"!==a.data.status)throw new Error(a.status);t("fetchSoppingCard")}catch(a){c.a.fire({icon:"error",title:"刪除失敗，請稍後再試！",toast:!0,showConfirmButton:!1,timer:2e3}),t("fetchSoppingCard")}}};var h={state:u,mutations:d,actions:m};const l={userInfo:{}},p={updateUserInfo(e,t){e.userInfo={...t}}};var f={state:l,mutations:p};const g={checkEmptyInput({commit:e},t){const n=t.findIndex(e=>""===e);if(-1!==n)return c.a.fire({icon:"warning",title:"請填寫所有欄位唷！",toast:!0,showConfirmButton:!1,timer:1500}),!0},checkEmail({commit:e},t){if(-1===t.indexOf("@")||-1===t.indexOf(".com"))return c.a.fire({icon:"warning",title:"email需含有 @ 與 .com ",toast:!0,showConfirmButton:!1,timer:1500}),!0},checkPassword({commit:e},t){if(t.password!==t.checkPassword)return c.a.fire({icon:"warning",title:"密碼確認與密碼不相同",toast:!0,showConfirmButton:!1,timer:1500}),!0},async googleSignIn({commit:e}){console.log("有到這裡");const t=await i["a"].getGoogle();console.log(t)}};var b={actions:g},k=n("a18c");a["a"].use(r["a"]);t["a"]=new r["a"].Store({state:{isAuthenticated:!1,currentUser:[],token:"",cartModel:!1,checkOutStep:0,filterKeyword:"",facebookConnect:!1,signinProcessing:!1},mutations:{isSigninProcessing(e){e.signinProcessing=!0},notSigninProcessing(e){e.signinProcessing=!1},addFilterKeyword(e,t){e.filterKeyword=t},changeFacebookConnect(e){e.facebookConnect=!0},changeCheckOutStep(e,t){e.checkOutStep=t},openCartModel(e){e.cartModel=!0},closeCartModel(e){e.cartModel=!1},setCurrentUser(e,t){e.currentUser={...e.currentUser,...t},e.isAuthenticated=!0,e.token=localStorage.getItem("gofarmmy_token")},logOut(e){localStorage.removeItem("gofarmmy_token"),localStorage.removeItem("go_farmmy_products"),e.cart.shoppingCart=[],e.currentUser=[],e.token="",e.isAuthenticated=!1,localStorage.removeItem("go_farmmy_user"),localStorage.removeItem("gofarmmy_facebook_connect"),localStorage.removeItem("go_farmmy_orderId")}},actions:{async fetchCurrentUser({commit:e}){try{const{data:t}=await i["a"].getCurrentUser();if("error"===t.status)throw new Error(t.message);return e("setCurrentUser",t.currentUser),!0}catch(t){return console.log(t.message),e("logOut"),!1}},async fetchFbUser({commit:e},t){try{const n=await i["a"].PostFbSignIn({name:t.name,email:t.email}),{data:a}=n;if("success"!==a.status)throw new Error(a.message);c.a.fire({icon:"success",title:`歡迎 ${a.user.name}回來！`,toast:!0,showConfirmButton:!1,timer:3e3}),localStorage.setItem("gofarmmy_token",a.token),e("setCurrentUser",a.user),k["a"].push({name:"Home"})}catch(n){console.log(n),c.a.fire({icon:"error",title:"登入錯誤，請洽客服",toast:!0,showConfirmButton:!1,timer:1500})}}},modules:{cart:h,order:f,authenticated:b}})},"4cce":function(e,t,n){"use strict";var a=n("2fa3");const r=()=>localStorage.getItem("gofarmmy_token");t["a"]={PostSignIn({email:e,password:t}){return a["a"].post("/users/signin",{email:e,password:t},{validateStatus:function(e){return e<=500}})},PostFbSignIn({name:e,email:t}){return a["a"].post("/users/fbSignIn",{name:e,email:t},{validateStatus:function(e){return e<=500}})},PostGoogleSignIn({token:e}){return a["a"].post("/users/googleSignIn",{token:e},{validateStatus:function(e){return e<=500}})},PostSignUp({name:e,email:t,password:n,checkPassword:r}){return a["a"].post("/users",{name:e,email:t,password:n,checkPassword:r},{validateStatus:function(e){return e<=500}})},PutUser({name:e,email:t,password:n,newPassword:o,checkPassword:c}){return a["a"].put("/users",{name:e,email:t,password:n,newPassword:o,checkPassword:c},{validateStatus:function(e){return e<=500},headers:{Authorization:"Bearer "+r()}})},getCurrentUser(){return a["a"].get("/users/currentUser",{headers:{Authorization:"Bearer "+r()}})}}},5165:function(e,t,n){"use strict";n("51e5")},"51e5":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);var a=n("2b0e"),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},o=[],c={name:"App",mounted(){window.fbAsyncInit=function(){window.FB.init({appId:"279524904068988",cookie:!0,xfbml:!0,version:"v12.0"}),window.gapi.load("auth2",()=>{window.gapi.auth2.init({client_id:"502621069725-6ksmjc0une7bfj1m7k0tj9gv5gi1cif4.apps.googleusercontent.com"})})}}},i=c,s=(n("5165"),n("2877")),u=Object(s["a"])(i,r,o,!1,null,null,null),d=u.exports,m=n("a18c"),h=n("4360");(function(e,t,n){var a,r=e.getElementsByTagName(t)[0];e.getElementById(n)||(a=e.createElement(t),a.id=n,a.src="//connect.facebook.net/zh_TW/sdk.js",r.parentNode.insertBefore(a,r))})(document,"script","facebook-jssdk"),a["a"].config.productionTip=!1,new a["a"]({router:m["a"],store:h["a"],render:e=>e(d)}).$mount("#app")},a18c:function(e,t,n){"use strict";var a=n("2b0e"),r=n("8c4f"),o=n("4360"),c=n("3d20"),i=n.n(c);a["a"].use(r["a"]);const s=[{path:"/",name:"None",redirect:"/goFarmmy"},{path:"/goFarmmy",name:"Home",component:()=>n.e("chunk-3127b385").then(n.bind(null,"f4a9"))},{path:"/goFarmmy/about",name:"About",component:()=>n.e("chunk-710b448a").then(n.bind(null,"2664"))},{path:"/goFarmmy/product/detail/:id",name:"Product-Detail",component:()=>n.e("chunk-5a5675a9").then(n.bind(null,"5f47"))},{path:"/goFarmmy/product",name:"Product",component:()=>n.e("chunk-2078c21c").then(n.bind(null,"d2f1"))},{path:"/goFarmmy/producer",name:"Producer",component:()=>n.e("chunk-c7879cac").then(n.bind(null,"6213"))},{path:"/goFarmmy/user/profile",name:"User-Profile",component:()=>n.e("chunk-753b42ec").then(n.bind(null,"1511"))},{path:"/goFarmmy/user/order",name:"User-Order",component:()=>Promise.all([n.e("chunk-3a262b16"),n.e("chunk-1fb3d024")]).then(n.bind(null,"0435"))},{path:"/goFarmmy/user/order/:id",name:"User-Order-Page",component:()=>Promise.all([n.e("chunk-3a262b16"),n.e("chunk-55fd61f7")]).then(n.bind(null,"92b0"))},{path:"/goFarmmy/signin",name:"Sign-in",component:()=>Promise.all([n.e("chunk-6a420968"),n.e("chunk-73e0c042")]).then(n.bind(null,"4a33"))},{path:"/goFarmmy/signup",name:"Sign-up",component:()=>n.e("chunk-15dd1d9c").then(n.bind(null,"34c3"))},{path:"/goFarmmy/checkout/signin",name:"CheckOut-Sign-in",component:()=>Promise.all([n.e("chunk-6a420968"),n.e("chunk-00540dc5")]).then(n.bind(null,"8114"))},{path:"/goFarmmy/checkout/product",name:"CheckOut-Products",component:()=>n.e("chunk-2a27a44d").then(n.bind(null,"b381"))},{path:"/goFarmmy/checkout/information",name:"CheckOut-Info",component:()=>Promise.all([n.e("chunk-5ab19ff9"),n.e("chunk-55124650")]).then(n.bind(null,"3a6a"))},{path:"/goFarmmy/checkout/payment",name:"CheckOut-Payment",component:()=>Promise.all([n.e("chunk-5ab19ff9"),n.e("chunk-7f1cab86")]).then(n.bind(null,"552b"))},{path:"/goFarmmy/checkout/complete",name:"CheckOut-Complete",component:()=>n.e("chunk-4b934a4c").then(n.bind(null,"834e"))}],u=new r["a"]({routes:s});u.beforeEach(async(e,t,n)=>{o["a"].commit("closeCartModel");const a=localStorage.getItem("gofarmmy_token"),r=JSON.parse(localStorage.getItem("go_farmmy_products"))||[];let c=!1,s=o["a"].state.isAuthenticated;const u=["Sign-in","CheckOut-Sign-in","Sign-up"],d=["User-Profile","User-Order","User-Order-Page","CheckOut-Products","CheckOut-Info","CheckOut-Payment","CheckOut-Complete"];if(!s&&!a&&d.includes(e.name))return void n("/goFarmmy/signin");if(s&&a&&u.includes(e.name))return void n("/goFarmmy");!s&&a&&(o["a"].dispatch("fetchSoppingCard"),s=await o["a"].dispatch("fetchCurrentUser")),s&&u.includes(t.name)&&(c=await o["a"].dispatch("fetchSoppingCard"));const m=o["a"].state.cart.shoppingCart;if(c&&u.includes(t.name)&&s){if(0!==m.length&&0!==r.length){const e=await i.a.fire({title:"是否更新購物車",text:"帳號內之購物車已有商品，是否需要更新",icon:"warning",focusCancel:!0,showCancelButton:!0,confirmButtonColor:"#808080",cancelButtonColor:"#2a2a2a",cancelButtonText:"維持原帳號內購物車",confirmButtonText:"更新為現有購物車"});e.isConfirmed&&await o["a"].dispatch("ChangeShoppingCart",r),localStorage.removeItem("go_farmmy_products")}0!==r.length&&0===m.length&&(o["a"].dispatch("addEmptyShoppingCart",r),localStorage.removeItem("go_farmmy_products"))}n()}),t["a"]=u},cc17:function(e,t,n){"use strict";var a=n("2fa3");const r=()=>localStorage.getItem("gofarmmy_token");t["a"]={getCart(){return a["a"].get("/cart",{headers:{Authorization:"Bearer "+r()}})},deleteCartItem({Id:e}){return a["a"].delete("/cart/cartItem/"+e,{headers:{Authorization:"Bearer "+r()}})},deleteAllCartItem(){return a["a"].delete("/cart/cartItem",{headers:{Authorization:"Bearer "+r()}})},postCart({productId:e,quantity:t}){return a["a"].post("/cart",{productId:e,quantity:t},{headers:{Authorization:"Bearer "+r()}})},postAddCartItem({Id:e}){return a["a"].post(`/cart/cartItem/${e}/add`,{Id:e},{headers:{Authorization:"Bearer "+r()}})},postSubCartItem({Id:e}){return a["a"].post(`/cart/cartItem/${e}/sub`,{Id:e},{headers:{Authorization:"Bearer "+r()}})}}}});
//# sourceMappingURL=app.f4403e9e.js.map