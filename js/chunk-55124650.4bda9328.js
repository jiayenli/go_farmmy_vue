(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-55124650"],{"3a6a":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"checkout-product"},[e.checkOrderProccessing?t("CheckOrderSpinner",{attrs:{text:e.checkOrderProccessingWord}}):e._e(),t("Navbar"),t("CartNavbar"),e._m(0),t("div",{staticClass:"checkout-product-step"},[t("CheckOutStep")],1),t("form",[t("div",{staticClass:"checkout-product-content"},[t("div",{staticClass:"checkout-product-content-top"},[t("h2",[e._v("訂購人資料")]),t("div",{staticClass:"checkout-product-content-top-input"},[t("div",{staticClass:"checkout-input checkout-product-content-top-input-name"},[e._m(1),t("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.customerName,expression:"userInfo.customerName"}],staticClass:"checkout-product-content-top-input-name-input",attrs:{placeholder:"請填寫「訂購人」姓名，如：李喵吉",id:"name",type:"text",autofocus:"",required:""},domProps:{value:e.userInfo.customerName},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"customerName",t.target.value)}}})]),t("div",{staticClass:"checkout-input checkout-product-content-top-input-phone"},[e._m(2),t("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.customerPhone,expression:"userInfo.customerPhone"}],staticClass:"checkout-product-content-top-input-phone-input",attrs:{placeholder:"請填寫「訂購人」電話，如：0910000xxx",id:"phone",type:"tel",required:""},domProps:{value:e.userInfo.customerPhone},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"customerPhone",t.target.value)}}})]),t("div",{staticClass:"checkout-input checkout-product-content-top-input-email"},[e._m(3),t("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.customerEmail,expression:"userInfo.customerEmail"}],staticClass:"checkout-product-content-top-input-email-input",attrs:{placeholder:"將會寄送訂單資訊至訂購人信箱",id:"email",type:"email",required:""},domProps:{value:e.userInfo.customerEmail},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"customerEmail",t.target.value)}}})])])]),t("div",{staticClass:"checkout-product-content-top"},[t("h2",[e._v("收件人資料")]),t("div",[e.sameInfo?t("i",{staticClass:"fas fa-circle",on:{click:e.cancelSameInfo}}):t("i",{staticClass:"far fa-circle",on:{click:e.addSameInfo}}),e._v("同訂購人資料 ")]),t("div",{staticClass:"checkout-product-content-top-input"},[t("div",{staticClass:"checkout-input checkout-product-content-top-input-name"},[e._m(4),t("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.recipientName,expression:"userInfo.recipientName"}],staticClass:"checkout-product-content-top-input-name-input",attrs:{id:"name",type:"text",autofocus:"",required:""},domProps:{value:e.userInfo.recipientName},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"recipientName",t.target.value)}}})]),t("div",{staticClass:"checkout-input checkout-product-content-top-input-phone"},[e._m(5),t("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.recipientPhone,expression:"userInfo.recipientPhone"}],staticClass:"checkout-product-content-top-input-phone-input",attrs:{id:"phone",type:"tel",required:""},domProps:{value:e.userInfo.recipientPhone},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"recipientPhone",t.target.value)}}})]),t("div",{staticClass:"checkout-input checkout-product-content-top-input-email"},[e._m(6),t("select",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.recipientCity,expression:"userInfo.recipientCity"}],attrs:{name:"city",id:"city",required:""},on:{change:function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.userInfo,"recipientCity",t.target.multiple?i:i[0])}}},[t("option",{attrs:{value:"man",disabled:"",selected:""}},[e._v("請選擇縣市")]),e._l(e.cities,(function(i){return t("option",{key:i.id,domProps:{value:i.name}},[e._v(" "+e._s(i.name)+" ")])}))],2),t("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.recipientAddress,expression:"userInfo.recipientAddress"}],staticClass:"checkout-product-content-top-input-email-input",attrs:{id:"email",type:"email",required:""},domProps:{value:e.userInfo.recipientAddress},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"recipientAddress",t.target.value)}}})]),t("div",{staticClass:"checkout-input checkout-product-content-top-input-email"},[e._m(7),t("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.recipientEmail,expression:"userInfo.recipientEmail"}],staticClass:"checkout-product-content-top-input-email-input",attrs:{id:"email",type:"email",required:""},domProps:{value:e.userInfo.recipientEmail},on:{input:function(t){t.target.composing||e.$set(e.userInfo,"recipientEmail",t.target.value)}}})])])])]),t("div",{staticClass:"checkout-product-button"},[t("button",{staticClass:"checkout-product-button-previous",attrs:{to:{name:"CheckOut-Products"}},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.previousPage.apply(null,arguments)}}},[e._v(" 上一步 ")]),t("button",{staticClass:"checkout-product-button-next",attrs:{type:"submit",to:{name:"CheckOut-Info"},disabled:!this.userInfo.customerName||!this.userInfo.customerPhone||!this.userInfo.customerEmail||!this.userInfo.customerName||!this.userInfo.recipientPhone||!this.userInfo.recipientEmail||!this.userInfo.recipientCity||!this.userInfo.recipientAddress},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.nextStep.apply(null,arguments)}}},[e._v(" 訂單確認 ")])])])],1)},r=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"checkout-product-cover"},[t("img",{staticClass:"checkout-product-cover-title",attrs:{src:i("c59a")}}),t("img",{staticClass:"checkout-product-cover-img",attrs:{src:i("b220")}})])},function(){var e=this,t=e._self._c;return t("label",{attrs:{for:"name"}},[t("h3",[e._v("訂購人姓名")])])},function(){var e=this,t=e._self._c;return t("label",{attrs:{for:"name"}},[t("h3",[e._v("訂購人電話")])])},function(){var e=this,t=e._self._c;return t("label",{attrs:{for:"name"}},[t("h3",[e._v("訂購人Email")])])},function(){var e=this,t=e._self._c;return t("label",{attrs:{for:"name"}},[t("h3",[e._v("收件人姓名")])])},function(){var e=this,t=e._self._c;return t("label",{attrs:{for:"name"}},[t("h3",[e._v("收件人電話")])])},function(){var e=this,t=e._self._c;return t("label",{attrs:{for:"name"}},[t("h3",[e._v("收件人地址")])])},function(){var e=this,t=e._self._c;return t("label",{attrs:{for:"name"}},[t("h3",[e._v("收件人Email")])])}],o=(i("14d9"),i("d9e2"),i("d178")),c=i("bd13"),s=i("94ee"),a=i("2f62"),u=i("3d20"),m=i.n(u),p=i("9b2a"),d=i("bc5c"),l={name:"checkout-product",components:{Navbar:o["a"],CartNavbar:c["a"],CheckOutStep:s["a"],CheckOrderSpinner:d["a"]},data(){return{sameInfo:!1,userInfo:{customerName:"",customerPhone:"",customerEmail:"",recipientName:"",recipientPhone:"",recipientEmail:"",recipientCity:"",recipientAddress:""},cities:[{name:"基隆市",id:"1"},{name:"台北市",id:"2"},{name:"新北市",id:"3"},{name:"桃園市",id:"4"},{name:"新竹市",id:"5"},{name:"新竹縣",id:"6"},{name:"苗栗市",id:"7"},{name:"台中縣",id:"8"},{name:"彰化縣",id:"9"},{name:"南投縣",id:"10"},{name:"雲林縣",id:"11"},{name:"嘉義市",id:"12"},{name:"嘉義縣",id:"13"},{name:"台南市",id:"14"},{name:"高雄市",id:"15"},{name:"屏東縣",id:"16"},{name:"台東縣",id:"18"},{name:"花蓮縣",id:"19"},{name:"宜蘭縣",id:"20"},{name:"澎湖縣",id:"21"},{name:"金門縣",id:"22"},{name:"連江縣",id:"23"}],checkOrderProccessing:!1,checkOrderProccessingWord:"訂單建立中",tradeInfo:{},orderId:0}},methods:{addSameInfo(){this.userInfo.recipientName=this.userInfo.customerName,this.userInfo.recipientEmail=this.userInfo.customerEmail,this.userInfo.recipientPhone=this.userInfo.customerPhone,this.sameInfo=!0},cancelSameInfo(){this.userInfo.recipientName="",this.userInfo.recipientEmail="",this.userInfo.recipientPhone="",this.sameInfo=!1},fetchInfo(){this.userInfo={...this.userInfo,customerName:this.currentUser.name,customerEmail:this.currentUser.email,...JSON.parse(localStorage.getItem("go_farmmy_user"))}},async nextStep(){if(0===this.cart.shoppingCart.length)return this.checkOrderProccessingWord="購物車內無商品，請添加商品",this.checkOrderProccessing=!0,void setTimeout(this.previousPage,1500);const{customerName:e,customerPhone:t,customerEmail:i,recipientName:n,recipientPhone:r,recipientEmail:o,recipientCity:c,recipientAddress:s}=this.userInfo;if(!e||!t||!i||!n||!r||!o||!c||!s)return void m.a.fire({icon:"warning",title:"所有欄位皆為必填喔",toast:!0,showConfirmButton:!1,timer:3e3});if(-1===i.indexOf("@")||-1===i.indexOf(".com")||-1===o.indexOf("@")||-1===o.indexOf(".com"))return void m.a.fire({icon:"warning",title:"email需含有 @ 與 .com ",toast:!0,showConfirmButton:!1,timer:3e3});const a=await m.a.fire({title:"訂單即將送出",text:"訂單確認後即不可修改，可至會員中心查看",icon:"warning",focusConfirm:!0,showCancelButton:!0,confirmButtonColor:"#808080",cancelButtonColor:"#2a2a2a",cancelButtonText:"取消",confirmButtonText:"訂單確認"});a.isConfirmed&&(localStorage.setItem("go_farmmy_user",JSON.stringify(this.userInfo)),this.postOrder())},async postOrder(){try{this.checkOrderProccessing=!0;const{customerName:e,customerPhone:t,customerEmail:i,recipientName:n,recipientPhone:r,recipientEmail:o,recipientCity:c,recipientAddress:s}=this.userInfo,a=await p["a"].postOrder({customerName:e,customerPhone:t,customerEmail:i,recipientName:n,recipientPhone:r,recipientEmail:o,recipientCity:c,recipientAddress:c+s});if("Successfully added an order"!==a.data.message)throw new Error(a.message);this.orderId=a.data.orderId,localStorage.setItem("go_farmmy_orderId",this.orderId),this.checkOrderProccessing=!1,this.$store.dispatch("ChangeShoppingCart",[]),this.$router.push({name:"CheckOut-Payment"})}catch(e){this.checkOrderProccessing=!1,m.a.fire({icon:"warning",title:"訂單建立失敗，請與客服聯繫 ",toast:!0,showConfirmButton:!1,timer:2e3})}},previousPage(){this.$router.push({name:"CheckOut-Products"})}},mounted(){this.$store.commit("changeCheckOutStep",2),this.fetchInfo()},computed:{...Object(a["b"])(["isAuthenticated","cart","currentUser"])},beforeDestroy(){this.$store.commit("changeCheckOutStep",0)},watch:{cart:{handler:function(){this.calculateTotal()},deep:!0}}},h=l,f=(i("5b8a"),i("2877")),v=Object(f["a"])(h,n,r,!1,null,"d8a66672",null);t["default"]=v.exports},"5b8a":function(e,t,i){"use strict";i("8fec")},"8fec":function(e,t,i){}}]);
//# sourceMappingURL=chunk-55124650.4bda9328.js.map